# Data Model: RAG Website Ingestion Pipeline

## Entities

### TextChunk
- **Description**: A segment of extracted content from a book page
- **Fields**:
  - `id` (string): Stable, deterministic identifier for the chunk
  - `content` (string): The actual text content of the chunk
  - `source_url` (string): URL of the original page
  - `page_title` (string): Title of the source page
  - `section_heading` (string): Section heading under which the content appears
  - `chunk_index` (integer): Sequential index of this chunk within the page
  - `hash` (string): Content hash for duplicate detection
- **Validation rules**:
  - Content must not be empty
  - Source URL must be a valid URL
  - ID must be unique within the system
- **Relationships**: Belongs to a VectorCollection

### EmbeddingVector
- **Description**: A numerical representation of text content generated by Cohere models
- **Fields**:
  - `vector_id` (string): Unique identifier for the vector in Qdrant
  - `embedding` (list[float]): The actual vector values from Cohere
  - `text_chunk_id` (string): Reference to the source TextChunk
  - `metadata` (dict): Associated metadata (source_url, page_title, section_heading, chunk_index)
- **Validation rules**:
  - Embedding must be a valid vector from Cohere
  - Metadata must contain required fields
- **Relationships**: References a TextChunk

### CrawledPage
- **Description**: A web page from the Docusaurus book that has been processed
- **Fields**:
  - `url` (string): The URL of the page
  - `title` (string): The title of the page
  - `content` (string): The raw content extracted from the page
  - `section_hierarchy` (list[string]): Path of sections from root to this page
  - `status` (string): Status of the crawling operation (success, error, etc.)
  - `crawled_at` (datetime): Timestamp when the page was crawled
- **Validation rules**:
  - URL must be valid
  - Status must be one of allowed values
- **Relationships**: Contains multiple TextChunks

### VectorCollection
- **Description**: A logical grouping in Qdrant containing related embedding vectors
- **Fields**:
  - `name` (string): Unique name for the collection
  - `size` (integer): Number of vectors in the collection
  - `created_at` (datetime): When the collection was created
  - `book_source` (string): Reference to the source book/website
- **Validation rules**:
  - Name must be unique in Qdrant
- **Relationships**: Contains multiple EmbeddingVectors

### ProcessingJob
- **Description**: Represents a single execution of the ingestion pipeline
- **Fields**:
  - `id` (string): Unique identifier for the job
  - `source_url` (string): Root URL of the book being processed
  - `status` (string): Current status (pending, running, completed, failed)
  - `pages_processed` (integer): Number of pages successfully processed
  - `chunks_created` (integer): Number of text chunks created
  - `vectors_stored` (integer): Number of vectors stored in Qdrant
  - `started_at` (datetime): When the job started
  - `completed_at` (datetime): When the job completed
  - `error_message` (string): Error details if the job failed
- **Validation rules**:
  - Status must be one of allowed values
  - Required fields must be present based on status